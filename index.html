<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>BADBOYSOLITAIRE üòà</title>
    <style>
        :root { --gold: #ffcc00; --dark: #0b0e11; --card: #1c2127; --green: #00ff88; --red: #ff4d4d; }
        body { background: var(--dark); color: white; font-family: 'Segoe UI', sans-serif; margin: 0; padding-bottom: 100px; overflow-x: hidden; user-select: none; }
        .header { background: #161a1e; padding: 15px; display: flex; justify-content: space-between; align-items: center; border-bottom: 3px solid var(--gold); position: sticky; top: 0; z-index: 900; }
        .admin-lock { border: 1px solid var(--gold); padding: 5px 12px; border-radius: 8px; cursor: pointer; text-align: center; background: rgba(255,204,0,0.05); }
        .admin-label { font-size: 0.8rem; font-weight: 900; color: var(--gold); display: block; }
        .player-id-display { font-size: 0.65rem; color: #aaa; display: block; }
        .bal-badge { background: rgba(255, 204, 0, 0.15); padding: 8px 15px; border-radius: 20px; border: 1px solid var(--gold); color: var(--gold); font-weight: 900; font-size: 1.2rem; }
        .tabs { display: flex; background: #1c2127; border-bottom: 1px solid #333; overflow-x: auto; }
        .tab { flex: 1; min-width: 80px; padding: 15px 5px; text-align: center; color: #848e9c; cursor: pointer; font-size: 0.75rem; font-weight: bold; text-transform: uppercase; }
        .tab.active { color: var(--gold); border-bottom: 2px solid var(--gold); background: rgba(255,204,0,0.1); }
        .gain-box { background: linear-gradient(135deg, rgba(0,255,136,0.1) 0%, #000 100%); border: 2px solid var(--green); border-radius: 15px; padding: 15px; margin: 15px auto; width: 220px; text-align: center; }
        .gain-amount { font-size: 2rem; font-weight: 900; color: #fff; }
        .game-area { max-width: 420px; margin: 0 auto; padding: 10px; text-align: center; }
        .grid-mines { display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; margin: 15px 0; }
        .cell { aspect-ratio: 1; background: #2b3139; border-radius: 8px; border: none; font-size: 1.4rem; cursor: pointer; box-shadow: 0 4px 0 #000; }
        .aviator-zone { background: #000; border-radius: 15px; border: 2px solid #333; padding: 15px; margin: 15px 0; position: relative; height: 200px; display: flex; flex-direction: column; justify-content: center; align-items: center; overflow: hidden; }
        .av-history { position: absolute; top: 0; left: 0; width: 100%; background: rgba(255,255,255,0.05); padding: 5px; display: flex; gap: 5px; overflow-x: auto; }
        .hist-pill { font-size: 0.7rem; font-weight: bold; padding: 3px 6px; border-radius: 10px; background: #222; border: 1px solid #555; }
        .av-multiplier { font-size: 4rem; font-weight: 900; color: var(--gold); z-index: 10; }
        .av-plane { font-size: 3rem; position: absolute; bottom: 20px; left: 20px; transition: 0.1s linear; }
        .fishing-zone { background: linear-gradient(180deg, #0a4f6d, #021d2b); border-radius: 15px; border: 2px solid #333; padding: 15px; margin: 15px 0; height: 200px; display: flex; flex-direction: column; justify-content: center; align-items: center; position: relative; overflow: hidden; }
        .fishing-msg { font-size: 1.1rem; font-weight: bold; color: white; position: absolute; top: 15px; z-index: 10; text-shadow: 0 2px 4px #000; text-align: center; }
        .fishing-bobber { font-size: 3rem; position: absolute; top: 50%; transform: translateY(-50%); z-index: 5; }
        .fishing-bobber.float { animation: floatBobber 2s ease-in-out infinite; }
        .fishing-bobber.bite { animation: biteShake 0.1s infinite; filter: drop-shadow(0 0 10px red); }
        .fish-result { font-size: 5rem; display: none; z-index: 15; animation: popUp 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        .waves { position: absolute; bottom: 0; width: 100%; height: 50px; background: rgba(0, 255, 136, 0.1); border-top: 2px dashed rgba(0, 255, 136, 0.3); }
        .panel { background: var(--card); border-radius: 20px; padding: 20px; margin: 10px; border: 1px solid #333; }
        input, select { background: #000; border: 1px solid #444; color: var(--gold); padding: 14px; border-radius: 10px; width: 100%; box-sizing: border-box; font-weight: 900; font-size: 1.1rem; margin-top: 5px; margin-bottom: 15px; text-align: center; outline: none; }
        .btn-main { background: linear-gradient(180deg, #ffcc00, #ff9900); border: none; color: black; padding: 18px; border-radius: 12px; font-weight: 900; width: 100%; cursor: pointer; text-transform: uppercase; font-size: 1.1rem; }
        .btn-pull { background: linear-gradient(180deg, #ff4d4d, #cc0000); color: white; }
        .btn-bonus { background: linear-gradient(180deg, #00ff88, #00cc6a); color: black; margin-bottom: 20px; font-size: 0.9rem; padding: 12px;}
        .footer { position: fixed; bottom: 0; width: 100%; background: #161a1e; display: flex; justify-content: space-around; align-items: center; padding: 15px 0; border-top: 2px solid #333; z-index: 1000; }
        .btn-wa { background: var(--green); color: black; padding: 10px 20px; border-radius: 10px; font-weight: 900; border: none; font-size: 0.9rem; }
        .modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 2000; justify-content: center; align-items: center; }
        .modal-box { background: #1c2127; border: 2px solid var(--gold); padding: 25px; border-radius: 20px; width: 85%; max-width: 320px; text-align: center; position: relative; }
        .close-btn { position: absolute; top: 10px; right: 15px; color: #888; font-size: 1.5rem; cursor: pointer; }
        .boss-btn { width: 100%; padding: 15px; margin: 5px 0; border-radius: 10px; border: 1px solid #444; background: #222; color: white; font-weight: bold; cursor: pointer; }
        .reg-list { max-height: 200px; overflow-y: auto; text-align: left; background: #000; padding: 10px; border-radius: 10px; border: 1px solid #333; margin-top: 10px; }
        .reg-item { border-bottom: 1px solid #222; padding: 5px 0; font-size: 0.8rem; display: flex; justify-content: space-between; }
        @keyframes floatBobber { 0%, 100% { transform: translateY(-50%); } 50% { transform: translateY(calc(-50% + 10px)); } }
        @keyframes biteShake { 0% { transform: translateY(-50%) translateX(-2px); } 50% { transform: translateY(calc(-50% + 5px)) translateX(2px); } 100% { transform: translateY(-50%) translateX(-2px); } }
        @keyframes popUp { 0% { transform: scale(0) translateY(50px); } 100% { transform: scale(1) translateY(0); } }
    </style>
</head>
<body>

<div class="modal-overlay" id="authModal">
    <div class="modal-box">
        <h2 style="color:var(--gold); margin-top:0;">BADBOY<span style="color:white">SOLITAIRE üòà</span></h2>
        <p style="font-size:0.8rem; color:gray;">Cr√©ez un compte pour acc√©der.</p>
        <input type="text" id="pseudoInput" placeholder="Pseudo">
        <button class="btn-main" onclick="createAccount()">S'INSCRIRE</button>
    </div>
</div>

<div class="modal-overlay" id="adminModal">
    <div class="modal-box">
        <span class="close-btn" onclick="hidePanel()">√ó</span>
        <div id="admin-login">
            <h3 style="color:var(--gold);">BOSS PANEL üòà</h3>
            <input type="text" id="adminInput" placeholder="Code secret...">
            <button class="btn-main" onclick="checkCode()">ENTRER</button>
        </div>
        <div id="boss-menu" style="display:none;">
            <button class="boss-btn" onclick="bossTicket()">üéüÔ∏è TICKET (10 MIN)</button>
            <button class="boss-btn" onclick="showRegister()">üìã REGISTRE JOUEURS</button>
            <button class="boss-btn" onclick="bossDirect()">üí∞ RECHARGE DIRECTE</button>
            <button class="boss-btn" onclick="bossGodMode()">üî• MODE ILLIMIT√â</button>
        </div>
        <div id="boss-register" style="display:none;">
            <div class="reg-list" id="reg-list-content"></div>
            <button class="boss-btn" onclick="backToMenu()">RETOUR</button>
        </div>
    </div>
</div>

<div class="header">
    <div class="admin-lock" onclick="showPanel()">
        <span class="admin-label">üîí PANEL</span>
        <span id="player-id" class="player-id-display">ID: ...</span>
    </div>
    <div class="bal-badge"><span id="solde">0</span> F</div>
</div>

<div class="tabs">
    <div class="tab active" id="tab-mines" onclick="setGame('mines')">üí£ Mines</div>
    <div class="tab" id="tab-aviator" onclick="setGame('aviator')">üöÄ Aviator</div>
    <div class="tab" id="tab-fishing" onclick="setGame('fishing')">üé£ P√™che</div>
</div>

<div class="game-area">
    <div class="gain-box"><div class="gain-amount" id="pot">0 F</div></div>
    <div id="grid-mines" class="grid-mines"></div>
    <div id="grid-aviator" class="aviator-zone" style="display:none;">
        <div class="av-history" id="av-hist"></div>
        <div class="av-multiplier" id="av-mult">1.00x</div>
        <div class="av-plane" id="av-plane">‚úàÔ∏è</div>
    </div>
    <div id="grid-fishing" class="fishing-zone" style="display:none;">
        <div class="fishing-msg" id="f-msg">Attente...</div>
        <div class="fishing-bobber" id="f-bobber" style="display:none;">üî¥</div>
        <div class="fish-result" id="f-result">üêü</div>
        <div class="waves"></div>
    </div>
    <div class="panel">
        <button id="btn-bonus" class="btn-main btn-bonus" onclick="claimBonus()">üéÅ BONUS VENDREDI (500 F)</button>
        <label style="font-size: 0.7rem; color: gray;">MISE</label>
        <input type="number" id="mise" value="100">
        <div id="opt-mines">
            <select id="nb-mines">
                <option value="1">1 Mine</option>
                <option value="3" selected>3 Mines</option>
                <option value="5">5 Mines</option>
            </select>
        </div>
        <button id="btn-start" class="btn-main" onclick="play()">JOUER</button>
        <button id="btn-pull" class="btn-main btn-pull" style="display:none;" onclick="pullFish()">üé£ TIRER !</button>
        <button id="btn-cash" class="btn-main" style="display:none; background:var(--green);" onclick="cashOut()">ENCAISSER</button>
    </div>
</div>

<div class="footer">
    <button class="btn-wa" onclick="goWa('depot')">D√âP√îT</button>
    <button class="btn-wa" style="background:var(--red); color:white" onclick="goWa('retrait')">RETRAIT</button>
</div>

<script>
    let bal = 0, mode = 'mines', active = false, isBoss = false, potVal = 0, curBet = 0;
    let currentUser = localStorage.getItem('ndi_user'), uid = localStorage.getItem('ndi_id');
    let avHistArr = [1.05, 1.10], traps = [], minesOpened = 0, fishLossCount = 0;
    let fWaitTimer, fEscapeTimer, fishBiting = false;

    function checkAuth() { if(!currentUser) document.getElementById('authModal').style.display='flex'; else document.getElementById('player-id').innerText="ID: "+uid; }
    function createAccount() {
        let p = document.getElementById('pseudoInput').value.trim();
        if(p.length < 3) return alert("Pseudo court");
        uid = "BAD-"+Math.floor(1000+Math.random()*9000); currentUser = p;
        localStorage.setItem('ndi_user', p); localStorage.setItem('ndi_id', uid);
        let reg = JSON.parse(localStorage.getItem('ndi_reg') || "[]"); reg.push({p:p, id:uid}); localStorage.setItem('ndi_reg', JSON.stringify(reg));
        document.getElementById('player-id').innerText="ID: "+uid; document.getElementById('authModal').style.display='none';
    }
    checkAuth();

    function claimBonus() {
        let d = new Date(); if(d.getDay() !== 5) return alert("C'est vendredi seulement !");
        let today = d.toLocaleDateString(); if(localStorage.getItem('ndi_bonus') === today) return alert("D√©j√† r√©cup√©r√© !");
        localStorage.setItem('ndi_bonus', today); bal += 500; ui(); alert("+500 F !");
    }

    const gm = document.getElementById('grid-mines');
    for(let i=0; i<25; i++) { 
        let b = document.createElement('button'); b.className = 'cell'; 
        b.onclick = () => hitM(i, b); gm.appendChild(b); 
    }

    function setGame(g) {
        if(active) return; mode = g;
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.getElementById('tab-'+g).classList.add('active');
        document.getElementById('grid-mines').style.display = g==='mines'?'grid':'none';
        document.getElementById('grid-aviator').style.display = g==='aviator'?'flex':'none';
        document.getElementById('grid-fishing').style.display = g==='fishing'?'flex':'none';
        document.getElementById('opt-mines').style.display = g==='mines'?'block':'none';
    }

    function play() {
        curBet = parseInt(document.getElementById('mise').value);
        if(!isBoss && bal < curBet) return alert("Solde insuffisant !");
        if(!isBoss) bal -= curBet; ui(); active = true; potVal = curBet; minesOpened = 0;
        if(mode !== 'fishing') { document.getElementById('btn-start').style.display='none'; document.getElementById('btn-cash').style.display='block'; }

        if(mode === 'mines') {
            traps=[]; let n = parseInt(document.getElementById('nb-mines').value);
            while(traps.length < n) { let r = Math.floor(Math.random()*25); if(!traps.includes(r)) traps.push(r); }
            document.querySelectorAll('.cell').forEach(c => { c.innerText=''; c.style.background='#2b3139'; c.dataset.open="false"; });
            document.getElementById('pot').innerText = potVal + " F";
        }
        else if(mode === 'aviator') {
            let mult = 1.00; 
            // LOI 30% : 70% crash < 1.15
            let crash = Math.random() < 0.7 ? (Math.random()*0.15+1.00) : (Math.random()*1.8+1.1);
            let iv = setInterval(() => {
                mult += 0.02; document.getElementById('av-mult').innerText = mult.toFixed(2)+"x";
                potVal = Math.floor(curBet * mult); document.getElementById('pot').innerText = potVal + " F";
                if(mult >= crash) { clearInterval(iv); active=false; document.getElementById('av-mult').style.color='red'; avHistArr.unshift(mult.toFixed(2)); if(avHistArr.length>6) avHistArr.pop(); updateAv(); setTimeout(reset, 2000); }
            }, 85); window.avIv = iv;
        }
        else if(mode === 'fishing') {
            document.getElementById('btn-start').style.display='none'; document.getElementById('btn-pull').style.display='block';
            let bob = document.getElementById('f-bobber'); bob.style.display='block'; bob.className='fishing-bobber float';
            fWaitTimer = setTimeout(() => {
                fishBiting = true; bob.className='fishing-bobber bite';
                fEscapeTimer = setTimeout(() => { if(active) { active=false; fishLossCount++; reset(); } }, 700);
            }, Math.random()*3000+2000);
        }
    }

    function hitM(i, b) {
        if(!active || mode !== 'mines' || b.dataset.open === "true") return;
        // ALGORITHME 30% (70% risque explosion)
        if(traps.includes(i) || Math.random() < 0.70) {
            b.style.background = 'var(--red)'; b.innerText = 'üí£'; active = false; setTimeout(reset, 1500);
        } else {
            minesOpened++; b.dataset.open = "true"; b.style.background = 'var(--green)'; b.innerText = 'üíé';
            potVal = Math.floor(potVal * (1 + (parseInt(document.getElementById('nb-mines').value) * 0.15)));
            document.getElementById('pot').innerText = potVal + " F";
        }
    }

    function pullFish() {
        if(!active || mode !== 'fishing') return;
        clearTimeout(fWaitTimer); clearTimeout(fEscapeTimer);
        document.getElementById('f-bobber').style.display='none';
        if(!fishBiting) { fishLossCount++; reset(); }
        else {
            let res; 
            if(fishLossCount >= 5) { res={e:'ü¶à', m:5}; fishLossCount=0; }
            else { res = Math.random() < 0.7 ? {e:'üëû', m:0} : {e:'üê†', m:1.5}; if(res.m===0) fishLossCount++; }
            bal += Math.floor(curBet * res.m); ui(); document.getElementById('f-result').innerText=res.e; document.getElementById('f-result').style.display='block'; active=false; setTimeout(reset, 2000);
        }
    }

    function cashOut() {
        if(!active) return;
        if(mode === 'aviator') { clearInterval(window.avIv); document.getElementById('av-mult').style.color='var(--green)'; avHistArr.unshift(document.getElementById('av-mult').innerText.replace('x','')); updateAv(); }
        bal += potVal; ui(); reset();
    }

    function reset() {
        active = false; fishBiting = false; document.getElementById('btn-start').style.display='block'; document.getElementById('btn-cash').style.display='none';
        document.getElementById('btn-pull').style.display='none'; document.getElementById('pot').innerText="0 F";
        document.getElementById('f-result').style.display='none'; document.getElementById('f-bobber').style.display='none';
    }

    function updateAv() { let h = document.getElementById('av-hist'); h.innerHTML=''; avHistArr.forEach(v => h.innerHTML+=`<span class="hist-pill">${v}x</span>`); }
    function ui() { document.getElementById('solde').innerText = isBoss ? "BOSS" : bal; }
    function showPanel() { document.getElementById('adminModal').style.display='flex'; }
    function hidePanel() { document.getElementById('adminModal').style.display='none'; }
    function checkCode() {
        let v = document.getElementById('adminInput').value;
        if(v === "BOSS99") { document.getElementById('admin-login').style.display='none'; document.getElementById('boss-menu').style.display='block'; }
        else if(v.startsWith("BAD-")) { let p = v.split("-"); bal += parseInt(p[1]); ui(); hidePanel(); alert("RECHARGE OK üòà"); }
    }
    function showRegister() { 
        document.getElementById('boss-menu').style.display='none'; document.getElementById('boss-register').style.display='block';
        let l = document.getElementById('reg-list-content'), r = JSON.parse(localStorage.getItem('ndi_reg') || "[]");
        l.innerHTML=''; r.forEach(u => l.innerHTML += `<div class="reg-item"><span>${u.p}</span><span>${u.id}</span></div>`);
    }
    function backToMenu() { document.getElementById('boss-register').style.display='none'; document.getElementById('boss-menu').style.display='block'; }
    function bossTicket() { let m = prompt("Montant :"); if(m) { alert("BAD-"+m+"-"+(Date.now()+600000).toString(36)+"-Z"); } }
    function bossDirect() { let m = prompt("Montant :"); if(m) { bal+=parseInt(m); ui(); hidePanel(); } }
    function bossGodMode() { isBoss=true; ui(); hidePanel(); }

    function goWa(t) {
        let num = "2250707656355";
        if(t==='retrait') {
            if(bal < 1000) return alert("Retrait mini 1000 F");
            let m=bal, fee=0; if(m>=5000) fee=Math.floor(m*0.05); let net=m-fee; if(!isBoss) bal=0; ui();
            window.location.href=`https://wa.me/${num}?text=RETRAIT%20BADBOY%20${uid}%20SOLDE:${m}F%20NET:${net}F`;
        } else { window.location.href=`https://wa.me/${num}?text=DEPOT%20BADBOY%20${uid}`; }
    }
</script>
</body>
</html>
